
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="QM. Technologies Ltd.">
      
      
      
        <link rel="prev" href="../serialization/">
      
      
        <link rel="next" href="../quam-references/">
      
      
        
      
      
      <link rel="icon" href="../../assets/qm_logo_white.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Gate-Level Operations - The Quantum Abstract Machine - QUAM Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="entropy-bright" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#gate-level-operations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="The Quantum Abstract Machine - QUAM Documentation" class="md-header__button md-logo" aria-label="The Quantum Abstract Machine - QUAM Documentation" data-md-component="logo">
      
  <img src="../../assets/qm_logo_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The Quantum Abstract Machine - QUAM Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Gate-Level Operations
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="entropy-bright" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to high contrast mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to high contrast mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="entropy-high-contrast" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="entropy-dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="The Quantum Abstract Machine - QUAM Documentation" class="md-nav__button md-logo" aria-label="The Quantum Abstract Machine - QUAM Documentation" data-md-component="logo">
      
  <img src="../../assets/qm_logo_white.svg" alt="logo">

    </a>
    The Quantum Abstract Machine - QUAM Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome to QUAM
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM Installation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../demonstration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM Demonstration
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    QUAM Components
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    QUAM Components
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../components/quam-root/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM Root
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../components/channels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Channels
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../components/channel-ports/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Channel Ports
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../components/pulses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pulses
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../components/octave/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Octave
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../components/qubits-and-qubit-pairs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Qubits and Qubit Pairs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../components/custom-components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom QUAM Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    QUAM Features
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    QUAM Features
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM Features
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../serialization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Serialization and State Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Gate-Level Operations
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Gate-Level Operations
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#defining-a-qubit-level-component" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defining a Qubit-Level Component
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instantiate-quam" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instantiate QUAM
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qubit-pairs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Qubit pairs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transforming-a-pulse-into-a-qubit-gate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Transforming a Pulse into a Qubit Gate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transforming a Pulse into a Qubit Gate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-operations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating operations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-custom-macros" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating custom macros
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating custom macros">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#measure-macro" class="md-nav__link">
    <span class="md-ellipsis">
      
        Measure macro
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#method-macros" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method Macros
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Method Macros">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clifford-macro" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clifford macro
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quam-references/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Referencing Between Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrating-to-quam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Migrating to QUAM
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API References
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    API References
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API_references/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    QUAM Components
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    QUAM Components
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API_references/components/channels_API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM Channels API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API_references/components/pulses_API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM Pulses API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API_references/components/ports_API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM Ports API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API_references/components/hardware_API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM Hardware API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API_references/components/octave_API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM Octave API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API_references/components/quantum_components_API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM Quantum Components API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API_references/components/macro_API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM Macro API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API_references/components/basic_quam_API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BasicQUAM API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API_references/core/quam_classes_API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUAM Core Classes API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="gate-level-operations">Gate-Level Operations</h1>
<p>In this guide, we introduce how to build circuit-level QUA programs by focusing on three core concepts:</p>
<ol>
<li>Defining qubits (or qubit pairs)</li>
<li>Organizing them within a stateful container (the QUAM)</li>
<li>Transforming pulse-level operations into gate-level operations.</li>
</ol>
<p>By the end of this tutorial, you will be able to construct a simple program of the form:</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="n">program</span><span class="p">()</span> <span class="k">as</span> <span class="n">prog</span><span class="p">:</span>
    <span class="n">X</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>              <span class="c1"># Single-qubit gate</span>
    <span class="n">clifford</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>    <span class="c1"># Clifford gate from a predefined set</span>
    <span class="n">qubit_state</span> <span class="o">=</span> <span class="n">measure</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
</code></pre></div>
<p>This short snippet will apply specific gate operations to qubit q1 and then measure its state.</p>
<p>Below is the outline of what we'll cover:</p>
<ul>
<li>Defining a custom Transmon qubit class (inheriting from Qubit)</li>
<li>Creating a stateful QUAM container to hold multiple qubits or qubit pairs</li>
<li>Registering a qubit pulse macro (e.g., x180) and using it as a gate</li>
<li>Building custom macros for measurement and more complex gates (Cliffords)</li>
</ul>
<p>The goal is to clearly demonstrate the flow from hardware-level pulse definitions all the way to abstract, gate-level instructions in a QUA program.</p>
<h2 id="defining-a-qubit-level-component">Defining a Qubit-Level Component</h2>
<p>We'll begin by importing all the modules we need. Then, we'll define a Transmon class that inherits from Qubit.
In this example, a Transmon has an XY channel and an optional resonator channel for readout.</p>
<p>Inheriting from Qubit allows us to attach hardware-specific parameters (like channels) and any additional properties
relevant to our hardware setup.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">field</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">quam.components.ports</span><span class="w"> </span><span class="kn">import</span> <span class="n">FEMPortsContainer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">quam.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuamRoot</span><span class="p">,</span> <span class="n">quam_dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">quam.components.quantum_components</span><span class="w"> </span><span class="kn">import</span> <span class="n">Qubit</span><span class="p">,</span> <span class="n">QubitPair</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">quam.components</span><span class="w"> </span><span class="kn">import</span> <span class="n">MWChannel</span><span class="p">,</span> <span class="n">InOutMWChannel</span><span class="p">,</span> <span class="n">pulses</span>

<span class="nd">@quam_dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Transmon</span><span class="p">(</span><span class="n">Qubit</span><span class="p">):</span>
    <span class="n">xy</span><span class="p">:</span> <span class="n">MWChannel</span>
    <span class="n">resonator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InOutMWChannel</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="nd">@quam_dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Quam</span><span class="p">(</span><span class="n">QuamRoot</span><span class="p">):</span>
    <span class="n">ports</span><span class="p">:</span> <span class="n">FEMPortsContainer</span>
    <span class="n">qubits</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Qubit</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">qubit_pairs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">QubitPair</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</code></pre></div>
<h2 id="instantiate-quam">Instantiate QUAM</h2>
<p>QUAM is our top-level container for organizing ports, qubits, and qubit pairs. We start by creating a Quam instance
that includes a FEMPortsContainer, which helps route signals to and from the hardware.
Then we add two Transmon qubits, "q1" and "q2," referencing their microwave (MW) channels.
These channels are used for generating pulses that interact with the qubits.</p>
<div class="highlight"><pre><span></span><code><span class="n">machine</span> <span class="o">=</span> <span class="n">Quam</span><span class="p">(</span><span class="n">ports</span><span class="o">=</span><span class="n">FEMPortsContainer</span><span class="p">())</span>

<span class="c1">## Add qubits</span>
<span class="c1"># Here we create the MW output and input ports for q1.</span>
<span class="n">q1_xy_port</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">ports</span><span class="o">.</span><span class="n">get_mw_output</span><span class="p">(</span><span class="s2">&quot;con1&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">q1_resonator_out_port</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">ports</span><span class="o">.</span><span class="n">get_mw_output</span><span class="p">(</span><span class="s2">&quot;con1&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">q1_resonator_in_port</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">ports</span><span class="o">.</span><span class="n">get_mw_input</span><span class="p">(</span><span class="s2">&quot;con1&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Next, we instantiate q1 and specify its XY and resonator channels.</span>
<span class="n">q1</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="s2">&quot;q1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Transmon</span><span class="p">(</span>
    <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;q1&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="n">MWChannel</span><span class="p">(</span><span class="n">intermediate_frequency</span><span class="o">=</span><span class="mf">100e6</span><span class="p">,</span> <span class="n">opx_output</span><span class="o">=</span><span class="n">q1_xy_port</span><span class="o">.</span><span class="n">get_reference</span><span class="p">()),</span>
    <span class="n">resonator</span><span class="o">=</span><span class="n">InOutMWChannel</span><span class="p">(</span>
        <span class="n">intermediate_frequency</span><span class="o">=</span><span class="mf">100e6</span><span class="p">,</span>
        <span class="n">opx_output</span><span class="o">=</span><span class="n">q1_resonator_out_port</span><span class="o">.</span><span class="n">get_reference</span><span class="p">(),</span>
        <span class="n">opx_input</span><span class="o">=</span><span class="n">q1_resonator_in_port</span><span class="o">.</span><span class="n">get_reference</span><span class="p">(),</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="c1"># We create another qubit, q2. Here, the resonator channel is omitted for brevity.</span>
<span class="n">q2_xy_mw_output</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">ports</span><span class="o">.</span><span class="n">get_mw_output</span><span class="p">(</span><span class="s2">&quot;con1&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="s2">&quot;q2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Transmon</span><span class="p">(</span>
    <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;q2&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="n">MWChannel</span><span class="p">(</span>
        <span class="n">intermediate_frequency</span><span class="o">=</span><span class="mf">100e6</span><span class="p">,</span> <span class="n">opx_output</span><span class="o">=</span><span class="n">q2_xy_mw_output</span><span class="o">.</span><span class="n">get_reference</span><span class="p">()</span>
    <span class="p">),</span>
<span class="p">)</span>
</code></pre></div>
<p>We can view a quick summary of a qubit's configuration:</p>
<div class="highlight"><pre><span></span><code><span class="n">q1</span><span class="o">.</span><span class="n">print_summary</span><span class="p">()</span>
</code></pre></div>
<details>
<summary><code>q1.print_summary()</code> output</summary>
<div class="highlight"><pre><span></span><code>q1: Transmon
  id: &quot;q1&quot;
  macros: QuamDict Empty
  xy: MWChannel
    operations: QuamDict Empty
    id: None
    digital_outputs: QuamDict Empty
    sticky: None
    intermediate_frequency: 100000000.0
    thread: None
    core: None
    LO_frequency: &quot;#./upconverter_frequency&quot;
    RF_frequency: &quot;#./inferred_RF_frequency&quot;
    opx_output: &quot;#/ports/mw_outputs/con1/1/1&quot;
    upconverter: 1
  resonator: InOutMWChannel
    operations: QuamDict Empty
    id: None
    digital_outputs: QuamDict Empty
    sticky: None
    intermediate_frequency: 100000000.0
    thread: None
    core: None
    opx_input: &quot;#/ports/mw_inputs/con1/1/2&quot;
    time_of_flight: 140
    smearing: 0
    LO_frequency: &quot;#./upconverter_frequency&quot;
    RF_frequency: &quot;#./inferred_RF_frequency&quot;
    opx_output: &quot;#/ports/mw_outputs/con1/1/2&quot;
    upconverter: 1
</code></pre></div>
</details>
<h2 id="qubit-pairs">Qubit pairs</h2>
<p>Qubit pairs provide an abstraction for interactions between two qubits.
For example, you might need a specific gate that involves both a control qubit and a target qubit.
Here, we create a pair named "q1@q2" which references q1 as control and q2 as target.</p>
<div class="highlight"><pre><span></span><code><span class="n">machine</span><span class="o">.</span><span class="n">qubit_pairs</span><span class="p">[</span><span class="s2">&quot;q1@q2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QubitPair</span><span class="p">(</span>
    <span class="n">qubit_control</span><span class="o">=</span><span class="n">q1</span><span class="o">.</span><span class="n">get_reference</span><span class="p">(),</span> <span class="n">qubit_target</span><span class="o">=</span><span class="n">q2</span><span class="o">.</span><span class="n">get_reference</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div>
<p>You can then access this pair using:</p>
<div class="highlight"><pre><span></span><code><span class="n">q1</span> <span class="o">@</span> <span class="n">q2</span>
</code></pre></div>
<details>
<summary><code>q1 @ q2</code> output</summary>
<div class="highlight"><pre><span></span><code>QubitPair(id=&#39;q1@q2&#39;, macros={}, qubit_control=Transmon(id=&#39;q1&#39;, macros={}, xy=MWChannel(operations={}, id=None, digital_outputs={}, sticky=None, intermediate_frequency=100000000.0, thread=None, core=None, LO_frequency=5000000000.0, RF_frequency=5100000000.0, opx_output=MWFEMAnalogOutputPort(controller_id=&#39;con1&#39;, fem_id=1, port_id=1, band=1, upconverter_frequency=5000000000.0, upconverters=None, delay=0, shareable=False, sampling_rate=1000000000.0, full_scale_power_dbm=-11), upconverter=1), resonator=InOutMWChannel(operations={}, id=None, digital_outputs={}, sticky=None, intermediate_frequency=100000000.0, thread=None, core=None, opx_input=MWFEMAnalogInputPort(controller_id=&#39;con1&#39;, fem_id=1, port_id=2, band=1, downconverter_frequency=5000000000.0, gain_db=None, sampling_rate=1000000000.0, shareable=False), time_of_flight=140, smearing=0, LO_frequency=5000000000.0, RF_frequency=5100000000.0, opx_output=MWFEMAnalogOutputPort(controller_id=&#39;con1&#39;, fem_id=1, port_id=2, band=1, upconverter_frequency=5000000000.0, upconverters=None, delay=0, shareable=False, sampling_rate=1000000000.0, full_scale_power_dbm=-11), upconverter=1)), qubit_target=Transmon(id=&#39;q2&#39;, macros={}, xy=MWChannel(operations={}, id=None, digital_outputs={}, sticky=None, intermediate_frequency=100000000.0, thread=None, core=None, LO_frequency=5000000000.0, RF_frequency=5100000000.0, opx_output=MWFEMAnalogOutputPort(controller_id=&#39;con1&#39;, fem_id=1, port_id=2, band=1, upconverter_frequency=5000000000.0, upconverters=None, delay=0, shareable=False, sampling_rate=1000000000.0, full_scale_power_dbm=-11), upconverter=1), resonator=None))
</code></pre></div>
</details>
<p>A qubit pair can also be subclassed (similar to how Transmon subclasses Qubit)
if you need extra functionality (e.g., controlling tunable couplers).</p>
<h2 id="transforming-a-pulse-into-a-qubit-gate">Transforming a Pulse into a Qubit Gate</h2>
<p>In QUAM, a common pattern is to define a pulse (e.g., a square pulse) and then wrap it in a macro class.
This macro can be registered as a gate-level operation, allowing us to write high-level QUA code.</p>
<p>For example, below we define an "x180" pulse (a typical pi rotation around the X axis)
and then create a "PulseMacro". This macro is stored in "q1.macros["X"]" so we can call it as a gate.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quam.components.macro</span><span class="w"> </span><span class="kn">import</span> <span class="n">PulseMacro</span>

<span class="c1"># Define the actual pulse — a simple square envelope with amplitude and duration.</span>
<span class="n">q1</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="s2">&quot;x180&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pulses</span><span class="o">.</span><span class="n">SquarePulse</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Wrap the pulse in a macro so it can be invoked as a logical gate.</span>
<span class="n">q1</span><span class="o">.</span><span class="n">macros</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PulseMacro</span><span class="p">(</span><span class="n">pulse</span><span class="o">=</span><span class="n">q1</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="s2">&quot;x180&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_reference</span><span class="p">())</span>

<span class="c1"># Now we can use this macro in a QUA program:</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qm</span><span class="w"> </span><span class="kn">import</span> <span class="n">generate_qua_script</span><span class="p">,</span> <span class="n">qua</span>

<span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">program</span><span class="p">()</span> <span class="k">as</span> <span class="n">prog</span><span class="p">:</span>
    <span class="c1"># Apply the X gate to q1. This calls the macro we just defined.</span>
    <span class="n">q1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>

<span class="c1"># Print out the generated QUA code to see how it expands.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">generate_qua_script</span><span class="p">(</span><span class="n">prog</span><span class="p">))</span>
</code></pre></div>
<details>
<summary>Pulse macro output</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># Single QUA script generated at 2025-03-31 19:28:57.397848</span>
<span class="c1"># QUA library version: 1.2.2a4</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">qm</span><span class="w"> </span><span class="kn">import</span> <span class="n">CompilerOptionArguments</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qm.qua</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="k">with</span> <span class="n">program</span><span class="p">()</span> <span class="k">as</span> <span class="n">prog</span><span class="p">:</span>
    <span class="n">play</span><span class="p">(</span><span class="s2">&quot;x180&quot;</span><span class="p">,</span> <span class="s2">&quot;q1.xy&quot;</span><span class="p">)</span>


<span class="n">config</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">loaded_config</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
</details>
<h3 id="creating-operations">Creating operations</h3>
<p>To make a macro like "X" accessible as a gate-level operation in QUA,
we use an OperationsRegistry. The registry maps gate names (like X) to the correct macro for each qubit.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quam.core.operation</span><span class="w"> </span><span class="kn">import</span> <span class="n">OperationsRegistry</span>

<span class="n">operations_registry</span> <span class="o">=</span> <span class="n">OperationsRegistry</span><span class="p">()</span>

<span class="nd">@operations_registry</span><span class="o">.</span><span class="n">register_operation</span>
<span class="c1"># The function name below becomes the gate-level call (e.g., X(q1)).</span>
<span class="c1"># Note that internally, it will trigger the macro we assigned to &quot;q1.macros[&quot;X&quot;]&quot;.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">X</span><span class="p">(</span><span class="n">qubit</span><span class="p">:</span> <span class="n">Qubit</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># Implementation is resolved by the macros attached to the qubit.</span>
    <span class="k">pass</span>
</code></pre></div>
<p>Now calling X(q1) in QUA code triggers the macro q1.macros["X"].</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">program</span><span class="p">()</span> <span class="k">as</span> <span class="n">prog</span><span class="p">:</span>
    <span class="c1"># This uses the registry to look up the correct macro.</span>
    <span class="n">X</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">generate_qua_script</span><span class="p">(</span><span class="n">prog</span><span class="p">))</span>
</code></pre></div>
<details>
<summary>Operation program output</summary>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quam.components.macro</span><span class="w"> </span><span class="kn">import</span> <span class="n">PulseMacro</span>

<span class="c1"># Define the actual pulse — a simple square envelope with amplitude and duration.</span>
<span class="n">q1</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="s2">&quot;x180&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pulses</span><span class="o">.</span><span class="n">SquarePulse</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Wrap the pulse in a macro so it can be invoked as a logical gate.</span>
<span class="n">q1</span><span class="o">.</span><span class="n">macros</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PulseMacro</span><span class="p">(</span><span class="n">pulse</span><span class="o">=</span><span class="n">q1</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="s2">&quot;x180&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_reference</span><span class="p">())</span>

<span class="c1"># Now we can use this macro in a QUA program:</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qm</span><span class="w"> </span><span class="kn">import</span> <span class="n">generate_qua_script</span><span class="p">,</span> <span class="n">qua</span>

<span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">program</span><span class="p">()</span> <span class="k">as</span> <span class="n">prog</span><span class="p">:</span>
    <span class="c1"># Apply the X gate to q1. This calls the macro we just defined.</span>
    <span class="n">q1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>

<span class="c1"># Print out the generated QUA code to see how it expands.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">generate_qua_script</span><span class="p">(</span><span class="n">prog</span><span class="p">))</span>
</code></pre></div>
</details>
<h2 id="creating-custom-macros">Creating custom macros</h2>
<p>Often, a gate corresponds to a single pulse, and "PulseMacro" is enough. But sometimes, a gate may require
multiple pulses or more complex logic. In that case, we can define a custom macro by subclassing QubitMacro
(or QubitPairMacro if it involves two qubits).</p>
<p>Below, we create two macros as examples: a "measure" macro and a "clifford" macro.
These illustrate how to embed logic into your macros and integrate them with the QUAM.</p>
<h3 id="measure-macro">Measure macro</h3>
<p>For the measure macro, we define a readout pulse on q1's resonator channel. The macro itself, when called,
plays that pulse, reads I/Q data, and assigns a boolean state based on a threshold.</p>
<div class="highlight"><pre><span></span><code><span class="n">q1</span><span class="o">.</span><span class="n">resonator</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="s2">&quot;readout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pulses</span><span class="o">.</span><span class="n">SquareReadoutPulse</span><span class="p">(</span>
    <span class="n">length</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.215</span>
<span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quam.components.macro</span><span class="w"> </span><span class="kn">import</span> <span class="n">QubitMacro</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">quam.utils.qua_types</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuaVariableBool</span>

<span class="nd">@quam_dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MeasureMacro</span><span class="p">(</span><span class="n">QubitMacro</span><span class="p">):</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QuaVariableBool</span><span class="p">:</span>
        <span class="c1"># The macro reads I/Q data from the resonator channel.</span>
        <span class="n">I</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubit</span><span class="o">.</span><span class="n">resonator</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="s2">&quot;readout&quot;</span><span class="p">)</span>
        <span class="c1"># We declare a QUA variable to store the boolean result of thresholding the I value.</span>
        <span class="n">qubit_state</span> <span class="o">=</span> <span class="n">qua</span><span class="o">.</span><span class="n">declare</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
        <span class="n">qua</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">qubit_state</span><span class="p">,</span> <span class="n">I</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">qubit_state</span>
</code></pre></div>
<p>We attach an instance of this MeasureMacro to our qubit q1.</p>
<div class="highlight"><pre><span></span><code><span class="n">q1</span><span class="o">.</span><span class="n">macros</span><span class="p">[</span><span class="s2">&quot;measure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MeasureMacro</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.215</span><span class="p">)</span>
</code></pre></div>
<p>Now we can perform the "measure" operation within a QUA program:</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">program</span><span class="p">()</span> <span class="k">as</span> <span class="n">prog</span><span class="p">:</span>
    <span class="n">qubit_state</span> <span class="o">=</span> <span class="n">q1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s2">&quot;measure&quot;</span><span class="p">)</span>  <span class="c1"># returns a boolean variable</span>

<span class="nb">print</span><span class="p">(</span><span class="n">generate_qua_script</span><span class="p">(</span><span class="n">prog</span><span class="p">))</span>
</code></pre></div>
<p>Similar to the X gate, we can register a generic measure() operation:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@operations_registry</span><span class="o">.</span><span class="n">register_operation</span>
<span class="k">def</span><span class="w"> </span><span class="nf">measure</span><span class="p">(</span><span class="n">qubit</span><span class="p">:</span> <span class="n">Qubit</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QuaVariableBool</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div>
<p>This lets us call measure(q1) in a gate-like manner:</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">program</span><span class="p">()</span> <span class="k">as</span> <span class="n">prog</span><span class="p">:</span>
    <span class="n">qubit_state</span> <span class="o">=</span> <span class="n">measure</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">generate_qua_script</span><span class="p">(</span><span class="n">prog</span><span class="p">))</span>
</code></pre></div>
<details>
<summary>Measure macro output</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># Single QUA script generated at 2025-03-31 19:28:57.445853</span>
<span class="c1"># QUA library version: 1.2.2a4</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">qm</span><span class="w"> </span><span class="kn">import</span> <span class="n">CompilerOptionArguments</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qm.qua</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="k">with</span> <span class="n">program</span><span class="p">()</span> <span class="k">as</span> <span class="n">prog</span><span class="p">:</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="n">declare</span><span class="p">(</span><span class="n">fixed</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">declare</span><span class="p">(</span><span class="n">fixed</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">v3</span> <span class="o">=</span> <span class="n">declare</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">measure</span><span class="p">(</span><span class="s2">&quot;readout&quot;</span><span class="p">,</span> <span class="s2">&quot;q1.resonator&quot;</span><span class="p">,</span> <span class="n">dual_demod</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="s2">&quot;iw1&quot;</span><span class="p">,</span> <span class="s2">&quot;iw2&quot;</span><span class="p">,</span> <span class="n">v1</span><span class="p">),</span> <span class="n">dual_demod</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="s2">&quot;iw3&quot;</span><span class="p">,</span> <span class="s2">&quot;iw1&quot;</span><span class="p">,</span> <span class="n">v2</span><span class="p">))</span>
    <span class="n">assign</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span> <span class="p">(</span><span class="n">v1</span><span class="o">&gt;</span><span class="mf">0.215</span><span class="p">))</span>


<span class="n">config</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">loaded_config</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
</details>
<h2 id="method-macros">Method Macros</h2>
<p>In addition to defining macros as separate classes, QUAM supports defining macros directly as methods within your qubit class using the <code>@QuantumComponent.register_macro</code> decorator (or <code>@method_macro</code>). This provides a cleaner way to organize qubit-specific operations.</p>
<p>Here's an example of adding a reset method to the Transmon class:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quam.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumComponent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qm</span><span class="w"> </span><span class="kn">import</span> <span class="n">qua</span>

<span class="nd">@quam_dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Transmon</span><span class="p">(</span><span class="n">Qubit</span><span class="p">):</span>
    <span class="n">xy</span><span class="p">:</span> <span class="n">MWChannel</span>
    <span class="n">resonator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InOutMWChannel</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@QuantumComponent</span><span class="o">.</span><span class="n">register_macro</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset the qubit to ground state using active reset&quot;&quot;&quot;</span>
        <span class="c1"># Measure the qubit state</span>
        <span class="n">I</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resonator</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="s2">&quot;readout&quot;</span><span class="p">)</span>

        <span class="c1"># Apply a conditional π-pulse if qubit is in excited state</span>
        <span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">if_</span><span class="p">(</span><span class="n">I</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">&quot;x180&quot;</span><span class="p">)</span>

        <span class="c1"># Add a wait time for relaxation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>
<p><strong>Key Requirements:</strong></p>
<ol>
<li>Any pulses referenced in a method macro (like <code>"readout"</code> and <code>"x180"</code>) must be registered in the appropriate channel's <code>operations</code> dictionary before the macro is called</li>
<li>Method macros automatically become available via both <code>qubit.apply("method_name")</code> and direct method calls <code>qubit.method_name()</code></li>
<li>If a qubit doesn't have a specific channel (e.g., no <code>resonator</code>), calling that channel in a method macro will raise an <code>AttributeError</code></li>
</ol>
<details>
<summary>Complete working example with setup and usage</summary>
<p>Here's a full example showing how to set up qubits with channels, register pulses, and use the method macro:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">field</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">quam.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuamRoot</span><span class="p">,</span> <span class="n">quam_dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">quam.components.ports</span><span class="w"> </span><span class="kn">import</span> <span class="n">FEMPortsContainer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">quam.components.quantum_components</span><span class="w"> </span><span class="kn">import</span> <span class="n">Qubit</span><span class="p">,</span> <span class="n">QuantumComponent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">quam.components</span><span class="w"> </span><span class="kn">import</span> <span class="n">MWChannel</span><span class="p">,</span> <span class="n">InOutMWChannel</span><span class="p">,</span> <span class="n">pulses</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qm</span><span class="w"> </span><span class="kn">import</span> <span class="n">qua</span>

<span class="c1"># Define the Transmon qubit class with a method macro for reset</span>
<span class="nd">@quam_dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Transmon</span><span class="p">(</span><span class="n">Qubit</span><span class="p">):</span>
    <span class="n">xy</span><span class="p">:</span> <span class="n">MWChannel</span>
    <span class="n">resonator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InOutMWChannel</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@QuantumComponent</span><span class="o">.</span><span class="n">register_macro</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset the qubit to ground state using active reset&quot;&quot;&quot;</span>
        <span class="c1"># Measure the qubit state</span>
        <span class="n">I</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resonator</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="s2">&quot;readout&quot;</span><span class="p">)</span>

        <span class="c1"># Apply a conditional π-pulse if qubit is in excited state</span>
        <span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">if_</span><span class="p">(</span><span class="n">I</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">&quot;x180&quot;</span><span class="p">)</span>

        <span class="c1"># Add a wait time for relaxation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Set up the QUAM machine with a qubit</span>
<span class="nd">@quam_dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Quam</span><span class="p">(</span><span class="n">QuamRoot</span><span class="p">):</span>
    <span class="n">ports</span><span class="p">:</span> <span class="n">FEMPortsContainer</span>
    <span class="n">qubits</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Qubit</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>


<span class="n">machine</span> <span class="o">=</span> <span class="n">Quam</span><span class="p">(</span><span class="n">ports</span><span class="o">=</span><span class="n">FEMPortsContainer</span><span class="p">())</span>

<span class="c1"># Create the qubit with XY and resonator channels</span>
<span class="n">q1_xy_port</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">ports</span><span class="o">.</span><span class="n">get_mw_output</span><span class="p">(</span><span class="s2">&quot;con1&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">q1_resonator_out_port</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">ports</span><span class="o">.</span><span class="n">get_mw_output</span><span class="p">(</span><span class="s2">&quot;con1&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">q1_resonator_in_port</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">ports</span><span class="o">.</span><span class="n">get_mw_input</span><span class="p">(</span><span class="s2">&quot;con1&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">q1</span> <span class="o">=</span> <span class="n">Transmon</span><span class="p">(</span>
    <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;q1&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="n">MWChannel</span><span class="p">(</span><span class="n">intermediate_frequency</span><span class="o">=</span><span class="mf">100e6</span><span class="p">,</span> <span class="n">opx_output</span><span class="o">=</span><span class="n">q1_xy_port</span><span class="o">.</span><span class="n">get_reference</span><span class="p">()),</span>
    <span class="n">resonator</span><span class="o">=</span><span class="n">InOutMWChannel</span><span class="p">(</span>
        <span class="n">intermediate_frequency</span><span class="o">=</span><span class="mf">100e6</span><span class="p">,</span>
        <span class="n">opx_output</span><span class="o">=</span><span class="n">q1_resonator_out_port</span><span class="o">.</span><span class="n">get_reference</span><span class="p">(),</span>
        <span class="n">opx_input</span><span class="o">=</span><span class="n">q1_resonator_in_port</span><span class="o">.</span><span class="n">get_reference</span><span class="p">(),</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Register the pulses required by the reset method macro</span>
<span class="n">q1</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="s2">&quot;x180&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pulses</span><span class="o">.</span><span class="n">SquarePulse</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">q1</span><span class="o">.</span><span class="n">resonator</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="s2">&quot;readout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pulses</span><span class="o">.</span><span class="n">SquareReadoutPulse</span><span class="p">(</span>
    <span class="n">length</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.215</span>
<span class="p">)</span>

<span class="c1"># Create a QUA program that uses the reset method macro</span>
<span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">program</span><span class="p">()</span> <span class="k">as</span> <span class="n">prog</span><span class="p">:</span>
    <span class="c1"># Call the reset method macro directly</span>
    <span class="n">q1</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="c1"># OR use the apply method to call the macro by name</span>
    <span class="n">q1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s2">&quot;reset&quot;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Method macros appear in the macro registry</span>
<span class="nb">print</span><span class="p">(</span><span class="n">q1</span><span class="o">.</span><span class="n">get_macros</span><span class="p">())</span>  <span class="c1"># {&#39;reset&#39;: &lt;MethodMacro &#39;reset&#39;&gt;, &#39;align&#39;: &lt;MethodMacro &#39;align&#39;&gt;, ...}</span>
</code></pre></div>
</details>
<p>Method macros provide better code organization by keeping qubit-specific logic within the qubit class itself, while still maintaining full compatibility with the QUAM macro system.</p>
<h3 id="clifford-macro">Clifford macro</h3>
<p>Next, we define a single-qubit "CliffordMacro". For illustration, we will define a few pulses
that correspond to some of the first five Clifford gates.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Define additional pulses for x90, x180, y90, y180, etc.</span>
<span class="n">q1</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="s2">&quot;x90&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pulses</span><span class="o">.</span><span class="n">SquarePulse</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">axis_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">q1</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="s2">&quot;x180&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pulses</span><span class="o">.</span><span class="n">SquarePulse</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">axis_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">q1</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="s2">&quot;y90&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pulses</span><span class="o">.</span><span class="n">SquarePulse</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">axis_angle</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">q1</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="s2">&quot;y180&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pulses</span><span class="o">.</span><span class="n">SquarePulse</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">axis_angle</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nd">@quam_dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CliffordMacro</span><span class="p">(</span><span class="n">QubitMacro</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clifford_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># We use a QUA switch_ statement to choose which pulses to play in real time.</span>
        <span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">switch_</span><span class="p">(</span><span class="n">clifford_idx</span><span class="p">,</span> <span class="n">unsafe</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">case_</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
                <span class="c1"># Identity operation: do nothing except wait to preserve timing.</span>
                <span class="n">wait_duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubit</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="s2">&quot;x180&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="o">//</span> <span class="mi">4</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qubit</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">wait_duration</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">case_</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qubit</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">&quot;x180&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">case_</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qubit</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">&quot;y180&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">case_</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qubit</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">&quot;y180&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qubit</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">&quot;x180&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">case_</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="c1"># This is a composite gate (x90 followed by y90)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qubit</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">&quot;x90&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qubit</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s2">&quot;y90&quot;</span><span class="p">)</span>
            <span class="c1"># You can continue defining more Clifford cases here...</span>

<span class="c1"># Attach the macro to q1</span>
<span class="n">q1</span><span class="o">.</span><span class="n">macros</span><span class="p">[</span><span class="s2">&quot;clifford&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CliffordMacro</span><span class="p">()</span>

<span class="c1"># We can now call this macro using q1.apply(&quot;clifford&quot;, clifford_idx):</span>
<span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">program</span><span class="p">()</span> <span class="k">as</span> <span class="n">prog</span><span class="p">:</span>
    <span class="n">clifford_idx</span> <span class="o">=</span> <span class="n">qua</span><span class="o">.</span><span class="n">declare</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">q1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s2">&quot;clifford&quot;</span><span class="p">,</span> <span class="n">clifford_idx</span><span class="p">)</span>


<span class="c1"># As before, we register a qubit-generic function:</span>
<span class="nd">@operations_registry</span><span class="o">.</span><span class="n">register_operation</span>
<span class="k">def</span><span class="w"> </span><span class="nf">clifford</span><span class="p">(</span><span class="n">qubit</span><span class="p">:</span> <span class="n">Qubit</span><span class="p">,</span> <span class="n">clifford_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="c1"># Now we can call clifford(q1, clifford_idx) in our QUA program:</span>
<span class="k">with</span> <span class="n">qua</span><span class="o">.</span><span class="n">program</span><span class="p">()</span> <span class="k">as</span> <span class="n">prog</span><span class="p">:</span>
    <span class="n">clifford_idx</span> <span class="o">=</span> <span class="n">qua</span><span class="o">.</span><span class="n">declare</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">clifford</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">clifford_idx</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">generate_qua_script</span><span class="p">(</span><span class="n">prog</span><span class="p">))</span>
</code></pre></div>
<details>
<summary>Clifford output</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># Single QUA script generated at 2025-03-31 19:28:57.522055</span>
<span class="c1"># QUA library version: 1.2.2a4</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">qm</span><span class="w"> </span><span class="kn">import</span> <span class="n">CompilerOptionArguments</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qm.qua</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="k">with</span> <span class="n">program</span><span class="p">()</span> <span class="k">as</span> <span class="n">prog</span><span class="p">:</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="n">declare</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">if_</span><span class="p">((</span><span class="n">v1</span><span class="o">==</span><span class="mi">0</span><span class="p">),</span> <span class="n">unsafe</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">wait</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;q1.xy&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">elif_</span><span class="p">((</span><span class="n">v1</span><span class="o">==</span><span class="mi">1</span><span class="p">)):</span>
        <span class="n">play</span><span class="p">(</span><span class="s2">&quot;x180&quot;</span><span class="p">,</span> <span class="s2">&quot;q1.xy&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">elif_</span><span class="p">((</span><span class="n">v1</span><span class="o">==</span><span class="mi">2</span><span class="p">)):</span>
        <span class="n">play</span><span class="p">(</span><span class="s2">&quot;y180&quot;</span><span class="p">,</span> <span class="s2">&quot;q1.xy&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">elif_</span><span class="p">((</span><span class="n">v1</span><span class="o">==</span><span class="mi">3</span><span class="p">)):</span>
        <span class="n">play</span><span class="p">(</span><span class="s2">&quot;y180&quot;</span><span class="p">,</span> <span class="s2">&quot;q1.xy&quot;</span><span class="p">)</span>
        <span class="n">play</span><span class="p">(</span><span class="s2">&quot;x180&quot;</span><span class="p">,</span> <span class="s2">&quot;q1.xy&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">elif_</span><span class="p">((</span><span class="n">v1</span><span class="o">==</span><span class="mi">4</span><span class="p">)):</span>
        <span class="n">play</span><span class="p">(</span><span class="s2">&quot;x90&quot;</span><span class="p">,</span> <span class="s2">&quot;q1.xy&quot;</span><span class="p">)</span>
        <span class="n">play</span><span class="p">(</span><span class="s2">&quot;y90&quot;</span><span class="p">,</span> <span class="s2">&quot;q1.xy&quot;</span><span class="p">)</span>


<span class="n">config</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">loaded_config</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
</details>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Q.M Technologies Ltd.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.top", "toc.integrate", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotations", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>